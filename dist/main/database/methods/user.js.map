{"version":3,"sources":["../../../../src/main/database/methods/user.ts"],"sourcesContent":["import prisma from '@/database'\n\nexport async function queryDepartNameByDeptId(deptId: number) {\n  const result = await prisma.sys_dept.findFirst({\n    where: {\n      id: deptId,\n    },\n    select: {\n      dept_name: true,\n    },\n  })\n  return result?.dept_name\n}\n\nexport async function queryRoleIdByUserId(userId: number) {\n  const result = await prisma.sys_user_role.findFirst({\n    where: {\n      user_id: userId,\n    },\n    select: {\n      role_id: true,\n    },\n  })\n  return result?.role_id\n}\n\nexport async function queryRoleNameByRoleId(roleId: number) {\n  const result = await prisma.sys_role.findFirst({\n    where: {\n      id: roleId,\n    },\n    select: {\n      role_name: true,\n    },\n  })\n  return result?.role_name\n}\n\nexport async function queryUsers() {\n  return await prisma.sys_user.findMany()\n}\n\nexport async function queryUserByUserId(userId: number) {\n  const result = await prisma.sys_user.findUnique({\n    where: {\n      id: userId,\n    },\n    include: {\n      sys_dept: true,\n      sys_user_role: {\n        include: {\n          sys_role: {\n            include: {\n              sys_role_permission: {\n                include: {\n                  sys_permission: true,\n                },\n              },\n            },\n          },\n        },\n      },\n    },\n  })\n\n  return result\n}\n\nexport async function queryUserByLoginName(loginName: string) {\n  const result = await prisma.sys_user.findFirst({\n    where: {\n      login_name: loginName,\n    },\n    include: {\n      sys_dept: true,\n      sys_user_role: {\n        include: {\n          sys_role: {\n            include: {\n              sys_role_permission: {\n                include: {\n                  sys_permission: true,\n                },\n              },\n            },\n          },\n        },\n      },\n    },\n  })\n\n  return result\n}\n\nexport async function updatePasswordByUserId(userId: number, password: string) {\n  const result = await prisma.sys_user.update({\n    where: {\n      id: userId,\n    },\n    data: {\n      password,\n    },\n  })\n\n  return result\n}\n"],"names":["queryDepartNameByDeptId","queryRoleIdByUserId","queryRoleNameByRoleId","queryUsers","queryUserByUserId","queryUserByLoginName","updatePasswordByUserId","deptId","result","prisma","sys_dept","findFirst","where","id","select","dept_name","userId","sys_user_role","user_id","role_id","roleId","sys_role","role_name","sys_user","findMany","findUnique","include","sys_role_permission","sys_permission","loginName","login_name","password","update","data"],"mappings":"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"}